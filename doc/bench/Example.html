<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Tue Feb 11 17:18:21 EST 2014 -->
<title>Example</title>
<meta name="date" content="2014-02-11">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Example";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../bench/Driver.html" title="class in bench"><span class="strong">Prev Class</span></a></li>
<li><a href="../bench/MySQLJ.html" title="class in bench"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?bench/Example.html" target="_top">Frames</a></li>
<li><a href="Example.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">bench</div>
<h2 title="Class Example" class="title">Class Example</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>bench.Example</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>java.lang.Runnable</dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">Example</span>
extends java.lang.Object
implements java.lang.Runnable</pre>
<div class="block">Example prototype for a multi-client SQL benchmark.
 This benchmark performs repetitive INSERT operations against a single table, committing after each insert.
 It is run from the command line, for example:
 <pre>java com.parelastic.bench.test.Example -debug host=localhost port=3307
 </pre>
 You can vary database size, schema definitions and number of client threads by modifying the code and recompiling.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>dhentchel</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static char[]</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#chars">chars</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#HELP_TEXT">HELP_TEXT</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../bench/Example.html#Example(java.util.concurrent.atomic.AtomicBoolean, java.lang.String, boolean, java.lang.String, int)">Example</a></strong>(java.util.concurrent.atomic.AtomicBoolean&nbsp;runFlag,
       java.lang.String&nbsp;threadID,
       boolean&nbsp;debugFlag,
       java.lang.String&nbsp;url,
       int&nbsp;insertsPerCommit)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.sql.Connection</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#connection(java.lang.String)">connection</a></strong>(java.lang.String&nbsp;url)</code>
<div class="block">Create a database connection based on configured parameters.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.sql.PreparedStatement</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#createStatement(java.lang.String)">createStatement</a></strong>(java.lang.String&nbsp;statementStr)</code>
<div class="block">Return a prepared statement for the thread's local connection.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#errCount()">errCount</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#initializeDatabase(long)">initializeDatabase</a></strong>(long&nbsp;recordCount)</code>
<div class="block">Pre-load the database to a realistic size, populating indexes.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#loadDriver()">loadDriver</a></strong>()</code>
<div class="block">Initialize the MySQL JDBC driver.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#main(java.lang.String[])">main</a></strong>(java.lang.String[]&nbsp;args)</code>
<div class="block">Load the database and run the benchmark.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#parseCommandArgs(java.lang.String[])">parseCommandArgs</a></strong>(java.lang.String[]&nbsp;args)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#randText(int)">randText</a></strong>(int&nbsp;size)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#run()">run</a></strong>()</code>
<div class="block">Benchmark driver for each client thread.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#setStatementValues(java.sql.PreparedStatement)">setStatementValues</a></strong>(java.sql.PreparedStatement&nbsp;stmt)</code>
<div class="block">Set parameters for the SURVEY_INSERT prepared statement.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../bench/Example.html#txnCount()">txnCount</a></strong>()</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="chars">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chars</h4>
<pre>public static final&nbsp;char[] chars</pre>
</li>
</ul>
<a name="HELP_TEXT">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>HELP_TEXT</h4>
<pre>public static final&nbsp;java.lang.String HELP_TEXT</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Example(java.util.concurrent.atomic.AtomicBoolean, java.lang.String, boolean, java.lang.String, int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Example</h4>
<pre>public&nbsp;Example(java.util.concurrent.atomic.AtomicBoolean&nbsp;runFlag,
       java.lang.String&nbsp;threadID,
       boolean&nbsp;debugFlag,
       java.lang.String&nbsp;url,
       int&nbsp;insertsPerCommit)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="txnCount()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>txnCount</h4>
<pre>public&nbsp;long&nbsp;txnCount()</pre>
</li>
</ul>
<a name="errCount()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>errCount</h4>
<pre>public&nbsp;long&nbsp;errCount()</pre>
</li>
</ul>
<a name="connection(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>connection</h4>
<pre>public&nbsp;java.sql.Connection&nbsp;connection(java.lang.String&nbsp;url)</pre>
<div class="block">Create a database connection based on configured parameters.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>A valid MySQL Connection object</dd></dl>
</li>
</ul>
<a name="initializeDatabase(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initializeDatabase</h4>
<pre>public&nbsp;void&nbsp;initializeDatabase(long&nbsp;recordCount)</pre>
<div class="block">Pre-load the database to a realistic size, populating indexes.
 This ensures that indexes are populated and therefore record contention will be manageable when the peak load test starts.
 Insert operations are batched to improve performance.</div>
</li>
</ul>
<a name="createStatement(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createStatement</h4>
<pre>public&nbsp;java.sql.PreparedStatement&nbsp;createStatement(java.lang.String&nbsp;statementStr)</pre>
<div class="block">Return a prepared statement for the thread's local connection.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>staPE_2site-1tementStr</code> - Any SQL statement, including ? params as needed.</dd>
<dt><span class="strong">Returns:</span></dt><dd></dd></dl>
</li>
</ul>
<a name="setStatementValues(java.sql.PreparedStatement)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setStatementValues</h4>
<pre>public&nbsp;void&nbsp;setStatementValues(java.sql.PreparedStatement&nbsp;stmt)
                        throws java.sql.SQLException</pre>
<div class="block">Set parameters for the SURVEY_INSERT prepared statement.
 The parameter values are generated randomly, to ensure foreign keys are unique.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>stmt</code> - A prepared statement returned by the createStatement method.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd></dl>
</li>
</ul>
<a name="randText(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>randText</h4>
<pre>public&nbsp;java.lang.String&nbsp;randText(int&nbsp;size)</pre>
</li>
</ul>
<a name="run()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>run</h4>
<pre>public&nbsp;void&nbsp;run()</pre>
<div class="block">Benchmark driver for each client thread.
 Threads used the shared runFlag to synchronize start and stop.  The client repeatedly invokes a 
 prepared statement for a table INSERT, committing after each insert. Each client thread generates
 unique random data for the contents of the insert, and tracks successful and failed transactions.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>run</code>&nbsp;in interface&nbsp;<code>java.lang.Runnable</code></dd>
</dl>
</li>
</ul>
<a name="loadDriver()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadDriver</h4>
<pre>public static&nbsp;void&nbsp;loadDriver()</pre>
<div class="block">Initialize the MySQL JDBC driver.</div>
</li>
</ul>
<a name="parseCommandArgs(java.lang.String[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parseCommandArgs</h4>
<pre>public static&nbsp;void&nbsp;parseCommandArgs(java.lang.String[]&nbsp;args)</pre>
</li>
</ul>
<a name="main(java.lang.String[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;args)</pre>
<div class="block">Load the database and run the benchmark.
 This is a multi-threaded SQL benchmark.  The __runFlag__ object is used to gate the starting and stopping of client threads.
 Initially, the database is pre-loaded with INITIAL_DB_SIZE records, to ensure we get a reliable, steady-state measure free
 of any initial creation and index contention issues. Then the client threads are launched and notified to start executing
 the INSERT transactions.  In the run phase, the clients commit after each individual insert, which is slower than a batch
 operation would be, but more flexible and less prone to lock contention.
 During execution, the program periodically prints the current TPS rate and the accumulated number of errors.
 Upon completion, a brief report is printed summarizing transaction and error counts, along with overall transactions per second.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>args</code> - [-help] [-debug] [host=VAL] [port=VAL] [dbname=VAL] [user=VAL] [password=VAL]</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../bench/Driver.html" title="class in bench"><span class="strong">Prev Class</span></a></li>
<li><a href="../bench/MySQLJ.html" title="class in bench"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?bench/Example.html" target="_top">Frames</a></li>
<li><a href="Example.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
